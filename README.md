# Determined Malware Busting


> TLDR: We teach our GPUs to bust Malware!!

## Introduction

In this project we explore the capability of ML to detect Malware.
### In-Memory

The first step focuses on the detection of malware in memory dumps.

Malware often resides in the memory of a computer to avoid detection from anti-virus software.
The memory dump is a snapshot of the memory of a computer at a given time.

Since this is boring tabular data, we normalize the numeric columns and use a simple MLP to classify the data.
Once training the MLP yields success, we move to the coolest trend of the century: `throw transformers at everything` üèåüèΩ‚Äç‚ôÇÔ∏è

## Network data and Graph Convolutions

In a second step we focus on network data.
This step requires more prior worq since curated datasets are not available.
The approach is to gather `pcaps` from incidents, extract the network data with [zeek](https://www.zeek.org/), and label the data acording to the incident.

From here on we can build a graph dataset using the IP addresses as nodes and the network traffic as edges.

Now the power of Graph Convolutions can be fully released ‚ù§Ô∏è‚Äçüî•



## Determined AI

The author of this repo dreamfully wishes to have had access to the [Determined AI](https://determined.ai/) platform during this thesis-project.  

[Determined AI](https://determined.ai/) enables distributed training and hyperparameter search/tuning, while adding minimal overhead.

![search_space](https://user-images.githubusercontent.com/25290565/232587415-d954a776-915d-4916-9f98-3eae52c6da06.png)

Find a full arsenal of  pretty screenshots and an in-depth project review in our [Ode 2 Determined AI](DETERMINED.md).


### Setup

<!-- Yes, use docker compose, not docker-compose, otherwiee the true/false arguments will throw an error. -->
Make sure to set the `DET_MASTER_HOST` variable in the [`.env`](./.env) to your hosts IP.

Here's one way to get your host IP:

```bash
dig $(uname -n) +short
```
Pick the one IP if more than one are returned.
If your local DNS server resolves hostnames, you can simply fill in your hostname.

Now spin up the containers:

```bash
docker-compose up
```

Additional python-libs can be installed via the `startup-hook.sh` script.

The Determined web UI will be available at [http://localhost:8080](http://localhost:8080).
Default usernames are `determined` and `admin` with blank passwords.

### Running Experiments


Install dependencies:

```bash
poetry install
```

Dryrun of the experiment 4 debugging purposes:

```bash
poetry run python run.py
```


Brace yourself, and run the experiment:

```bash
det e create experiments/<pick-one>.yml .
```


## [Data](data/README.md)

The original dataset is from ...
The author offers an insightful [example](.data/README.md) of the dataset.
Find more information on the [offical homepage](https://www.unb.ca/cic/datasets/malmem-2022.html)

A pre-proccessed dataset is stored on my G-Drive. Here the direct download [link](https://docs.google.com/uc?export=download&id=1ot3t_5cAP2L3zP_tqK-1h2EM4WyMCeAI).

Store it in the `data` folder to reproduce the experiments:  
```bash
curl -L https://docs.google.com/uc?export=download&id=1ot3t_5cAP2L3zP_tqK-1h2EM4WyMCeAI -o data/datasetMalMem22.csv

```

Thanqs 4 reading & have much fun busting malware ü§çüêßü§ç

